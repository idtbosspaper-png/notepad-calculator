<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Notepad Calculator 2025</title>
  <style>
    :root{
      /* Keep textarea line height and stripe height in sync */
      --row: 28px;
      --rule: 1px;
    }

    body {
      font-family: monospace;
      margin: 0;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #f9f9f9;
    }

    .wrap {
      width: 92%;
      max-width: 900px;
      text-align: center;
    }

    h1 {
      margin: 0 0 14px;
      font-size: 28px;
      font-weight: 800;
      letter-spacing: .4px;
    }

    textarea {
      width: 100%;
      height: 520px;
      font-size: 20px;
      line-height: var(--row);
      padding: 12px;
      border: 1px solid #cbd5e1;
      border-radius: 10px;
      resize: vertical;
      white-space: pre;
      outline: none;

      /* Notepad lines */
      background:
        repeating-linear-gradient(
          to bottom,
          #fff 0 calc(var(--row) - var(--rule)),
          #eaeaea calc(var(--row) - var(--rule)) var(--row)
        );
      background-attachment: local;
      background-position: 0 12px; /* match top padding */
    }

    textarea:focus {
      border-color: #2563eb;
      box-shadow: 0 0 0 3px rgba(37,99,235,.15);
    }

    footer {
      margin-top: 10px;
      font-size: 14px;
      color: #6b7280;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Notepad Calculator 2025</h1>
    <textarea id="pad" placeholder=""></textarea>
    <footer>Developed by Ibrahim Harris</footer>
  </div>

  <script>
    const pad = document.getElementById('pad');

    // Regex to detect if a line has at least one math operator.
    const HAS_OPERATOR = /[+\-*/%()]/;

    function updateInline() {
      const lines = pad.value.split('\n');

      const updated = lines.map(line => {
        let raw = line;                 // keep original spacing
        let expr = raw.trim();

        // Strip an existing "= ..." part to avoid compounding
        if (expr.includes('=')) {
          expr = expr.split('=')[0].trim();
        }

        // Ignore empty lines
        if (!expr) return raw;

        // Only evaluate if the line actually looks like an expression
        if (!HAS_OPERATOR.test(expr)) {
          // e.g., a plain number like "14,959" => leave as-is
          return raw;
        }

        try {
          const val = Function('"use strict";return (' + expr.replace(/,/g, '') + ')')();
          if (typeof val === 'number' && !Number.isNaN(val)) {
            // Preserve original left side spacing, append formatted result
            const leftPad = raw.match(/^\s*/)?.[0] ?? '';
            return leftPad + expr + ' = ' + val.toLocaleString();
          }
        } catch (e) {
          // Not a valid expressionâ€”leave as typed
        }
        return raw;
      });

      // Preserve caret as best as possible
      const pos = pad.selectionStart;
      pad.value = updated.join('\n');
      pad.selectionEnd = pos;
    }

    // Live update as you type
    pad.addEventListener('input', updateInline);
  </script>
</body>
</html>
